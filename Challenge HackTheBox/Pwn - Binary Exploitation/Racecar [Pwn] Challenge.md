# Racecar [Pwn] Challenge

[https://app.hackthebox.com/challenges/racecar](https://app.hackthebox.com/challenges/racecar)

Le premier indice est données dans la description du challenges racecar ce lis dans les deux sens.

On démarre le serveur et on dl le fichier donnéesLe fichier données est un exécutable binaire.

![Untitled](Racecar%20%5BPwn%5D%20Challenge%2038a3341681be40f3bd1b194f6f9dbfc6/Untitled.png)

Current coin est à 69 a chaque lancement

On peux mettre un Nom et un Nickname. Deux choix après ça Info des voitures et sélection de celle-ci. 

![Untitled](Racecar%20%5BPwn%5D%20Challenge%2038a3341681be40f3bd1b194f6f9dbfc6/Untitled%201.png)

Après choix de la voiture on choisit un circuit.

![Untitled](Racecar%20%5BPwn%5D%20Challenge%2038a3341681be40f3bd1b194f6f9dbfc6/Untitled%202.png)

Après plusieurs essaie j’en viens à la conclusion que si on choisit la voiture 1 elle gagne sur le circuit 2 dans 100% des cas dans le cas inverse si on choisit la voiture 2 elle gagne toujours sur le circuit 1.

Je suis allé voir le site après :

![Untitled](Racecar%20%5BPwn%5D%20Challenge%2038a3341681be40f3bd1b194f6f9dbfc6/Untitled%203.png)

J’ai rien trouvé de spécial à faire dessus.

J’ai tenté de trouvé des fichier caché dans l’exécutable avec binwalk mais je n’ai rien trouvé. 

---

Je n’ai rien trouvé après tous ça je vais donc essayer de reverse l’exécutable pour obtenir plus d’info

Avec `file racecar` on constate que le fichier est un ELF. 

On va utiliser readelf qui nous permet d’énumérer énormément de chose du programme.

![Untitled](Racecar%20%5BPwn%5D%20Challenge%2038a3341681be40f3bd1b194f6f9dbfc6/Untitled%204.png)

On analyse la fonction main :

![Untitled](Racecar%20%5BPwn%5D%20Challenge%2038a3341681be40f3bd1b194f6f9dbfc6/Untitled%205.png)

Ce code va simplement checker si les entrés sont valides ou non.

Sinon m’expulser du programme. Mais une fonction retient l’attention c’est `car_menu()`

`car_info()` ne contient que les infos des voitures comme vu précédemment.

![Untitled](Racecar%20%5BPwn%5D%20Challenge%2038a3341681be40f3bd1b194f6f9dbfc6/Untitled%206.png)

On peux lire que si on gagne flag.txt devrais s’ouvrir mais a chaque fois que l’on gagne il ne marche pas.

Si on créé un flag.txt sur notre ordinateur et qu’on exécute le programme on à un nouveau message :

![Untitled](Racecar%20%5BPwn%5D%20Challenge%2038a3341681be40f3bd1b194f6f9dbfc6/Untitled%207.png)

Dans `car_menu()` on a un print d’une façon non sécurisé

![Untitled](Racecar%20%5BPwn%5D%20Challenge%2038a3341681be40f3bd1b194f6f9dbfc6/Untitled%208.png)

Si nous mettons sur notre ordinateur un flag.txt contenant AAAA et que nous mettons %p 14 fois avant ce printf nous obtenons 0x41414141 

Si nous envoyons une trentaine de %p au serveur nous avons le flag écrit a partir de la quatorzième adresse print en hex. Hex to Ascii et nous obtenons le flag.