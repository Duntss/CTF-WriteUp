# Jeeves [Pwn] Challenges

Le binaire :

Nous avons un binaire 64 bit nommée Jeeves il est simple nous pouvons le lancé et nous avons 1 seul mot à mettre à l’intérieur.

Si nous analysons le fichier avec ghidra :

Premier problème nous pouvons voir un get [44] le get ne vas pas surveiller nos entré et nous pouvons mettre plus que la limite de 44 caractères dans le get qui est le mot de passe que nous ajoutons.

Comme nous le savons un exploitation de binaire fonctionne avec l’écriture dans le stack.

En mettant 44 caractères nous allons remplir le ESP et puisque nous pouvons en mettre plus nous allons écrire plus nous allons écrire dans EBP comme ci-dessous. Nous devons donc écrire un message piégé qui va changer la valeur d’une variable pour changer un if statement du code.

![Untitled](Jeeves%20%5BPwn%5D%20Challenges%20866b94144bf54ddaaeea8cdc6e99bd41/Untitled.png)

`python2 -c 'print "A"*60 + "\xb3\xba\x37\x13"' > payload.txt`

Avec cette commande nous allons créer un message dans payload.txt qui va avoir 60 caractères A pour remplir le get et `"\xb3\xba\x37\x13"` va nous permettre de modifier la valeur de la variable.

Nous nous retrouvons avec ce payload 

`aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\xb3\xba7\x13\x00\x00\x00\x00`

`AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA��7`

On peut enoyer le payload maintenant sur le serveur données par HTB.